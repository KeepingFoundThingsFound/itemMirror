!function t(e,o,n){function i(a,s){if(!o[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(r)return r(a,!0);var m=new Error("Cannot find module '"+a+"'");throw m.code="MODULE_NOT_FOUND",m}var u=o[a]={exports:{}};e[a][0].call(u.exports,function(t){var o=e[a][1][t];return i(o?o:t)},u,u.exports,t,e,o,n)}return o[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(t,e,o){"use strict";function n(t){var e=this;if(t.element)i(t.element,e);else{if(!t.commonData)throw new Error(a.missingParameter);r(t.commonData,e)}}function i(t,e){var o,n,i,r;for(e.commonData={ID:t.getAttribute(u),displayText:t.getAttribute(p),associatedXooMLFragment:t.getAttribute(l),associatedXooMLDriver:t.getAttribute(f),associatedSyncDriver:t.getAttribute(g),associatedItemDriver:t.getAttribute(d),associatedItem:t.getAttribute(h),localItem:t.getAttribute(v),isGrouping:JSON.parse(t.getAttribute(y))},e.namespace={},o=t.getElementsByTagName(m),n=0;n<o.length;n+=1){for(r=o[n],i=r.namespaceURI,e.namespace[i]={},e.namespace[i].attributes={},n=0;n<r.attributes.length;n+=1)"xmlns"!==r.attributes[n].name&&(e.namespace[i].attributes[r.attributes[n].localName]=r.getAttributeNS(i,r.attributes[n].localName));e.namespace[i].data=r.textContent}}function r(t,e){if(!t)throw a.nullArgument;e.commonData={displayText:t.displayText||null,associatedXooMLFragment:t.associatedXooMLFragment||null,associatedXooMLDriver:t.associatedXooMLDriver||null,associatedSyncDriver:t.associatedSyncDriver||null,associatedItemDriver:t.associatedItemDriver||null,associatedItem:t.associatedItem||null,localItem:t.localItem||null,isGrouping:t.isGrouping||!1,ID:s.generateGUID()},e.namespace={}}var a=t("./XooMLExceptions"),s=t("./XooMLUtil"),c="association",m="associationNamespaceElement",u="ID",p="displayText",l="associatedXooMLFragment",f="associatedXooMLDriver",g="associatedSyncDriver",d="associatedItemDriver",h="associatedItem",v="localItem",y="isGrouping";n.prototype.toElement=function(){var t=this,e=document.createElementNS(null,c);return Object.keys(t.commonData).forEach(function(o){t.commonData[o]&&e.setAttribute(o,t.commonData[o])}),Object.keys(t.namespace).forEach(function(o){var n=document.createElementNS(o,m);Object.keys(t.namespace[o].attributes).forEach(function(e){n.setAttributeNS(o,e,t.namespace[o].attributes[e])}),n.textContent=t.namespace[o].data,e.appendChild(n)}),e},e.exports=n},{"./XooMLExceptions":8,"./XooMLUtil":9}],2:[function(t,e,o){"use strict";function n(t){var e=this;if(t.text)r(t.text,e);else if(t.element)a(t.element,e);else{if(!t.commonData)throw new Error(s.missingParameter);i(t.commonData,t.associations,e)}}function i(t,e,o){if(!t)throw s.nullArgument;o.commonData={displayName:t.displayName||null,schemaLocation:t.schemaLocation||null,schemaVersion:t.schemaVersion||null,itemDriver:t.itemDriver||null,itemDescribed:t.itemDescribed||null,syncDriver:t.syncDriver||null,xooMLDriver:t.xooMLDriver||null,GUIDGeneratedOnLastWrite:c.generateGUID()},o.associations={},e.forEach(function(t){var e=t.commonData.ID;o.associations[e]=t}),o.namespace={}}function r(t,e,o){var n=new DOMParser,i=n.parseFromString(t,"application/xml");a(i.children[0],e,o)}function a(t,e){var o,n,i,r,a,s;for(e.commonData={fragmentNamespaceElement:t.getAttribute(f),schemaVersion:t.getAttribute(g),schemaLocation:t.getAttribute(d),itemDescribed:t.getAttribute(h),displayName:t.getAttribute(v),itemDriver:t.getAttribute(y),syncDriver:t.getAttribute(D),xooMLDriver:t.getAttribute(I),GUIDGeneratedOnLastWrite:t.getAttribute(_)},e.namespace={},o=t.getElementsByTagName(f),n=0;n<o.length;n+=1){for(a=o[n],s=a.namespaceURI,e.namespace[s]={},e.namespace[s].attributes={},n=0;n<a.attributes.length;n+=1)"xmlns"!==a.attributes[n].name&&(e.namespace[s].attributes[a.attributes[n].localName]=a.getAttributeNS(s,a.attributes[n].localName));e.namespace[s].data=a.textContent}for(e.associations={},i=t.getElementsByTagName(p),n=0;n<i.length;n+=1)r=i[n].getAttribute(l),e.associations[r]=new m({element:i[n]})}var s=t("./XooMLExceptions"),c=t("./XooMLUtil"),m=t("./AssociationEditor"),u="fragment",p="association",l="ID",f="fragmentNamespaceElement",g="schemaVersion",d="schemaLocation",h="itemDescribed",v="displayName",y="itemDriver",D="syncDriver",I="xooMLDriver",_="GUIDGeneratedOnLastWrite",x="http://kftf.ischool.washington.edu/xmlns/xooml";n.prototype.updateID=function(){var t=c.generateGUID();return this.commonData.GUIDGeneratedOnLastWrite=t,t},n.prototype.toElement=function(){var t=this,e=document.createElementNS(x,u);return Object.keys(t.commonData).forEach(function(o){var n=t.commonData[o];n&&e.setAttribute(o,n)}),Object.keys(t.namespace).forEach(function(o){var n=document.createElementNS(o,f);Object.keys(t.namespace[o].attributes).forEach(function(e){n.setAttributeNS(o,e,t.namespace[o].attributes[e])}),n.textContent=t.namespace[o].data,e.appendChild(n)}),Object.keys(t.associations).forEach(function(o){e.appendChild(t.associations[o].toElement())}),e},n.prototype.toString=function(){var t=new XMLSerializer;return t.serializeToString(this.toElement())},e.exports=n},{"./AssociationEditor":1,"./XooMLExceptions":8,"./XooMLUtil":9}],3:[function(t,e,o){"use strict";function n(t,e){var o=this;if(!t.clientInterface)throw new Error("Client parameter missing");this.clientInterface=t.clientInterface;var n=this.clientInterface.auth2.getAuthInstance().currentUser.get().getAuthResponse();return this._AUTH_HEADER={Authorization:"Bearer "+n.access_token},this._DRIVE_FILE_API="https://www.googleapis.com/drive/v2/files/",o._FOLDER_MIMETYPE="application/vnd.google-apps.folder",e(!1,o)}var i=t("./XooMLConfig"),r=t("./AssociationEditor");n.prototype.isGroupingItem=function(t,e){var o=this;$.get({url:o._DRIVE_FILE_API+t,headers:o._AUTH_HEADER}).then(function(t){e(!1,o._FOLDER_MIMETYPE===t.mimeType)}).fail(function(){e("No response from GET: "+t)})},n.prototype.createGroupingItem=function(t,e,o){var n=this;$.post({url:n._DRIVE_FILE_API,headers:n._AUTH_HEADER,body:{mimeType:n._FOLDER_MIMETYPE,title:e,parents:[t]}}).then(function(t){o(!1,t.id)}).fail(function(){o("Failed to make POST request for new grouping item. Check network requests for more deatils")})},n.prototype.createNonGroupingItem=function(t,e,o){var n=this;n._dropboxClient.writeFile(t,e,function(t,e){return t?n._showDropboxError(t,o):o(!1,e)})},n.prototype.deleteGroupingItem=function(t,e){var o=this;o._dropboxClient.remove(t,function(t,n){return t?o._showDropboxError(t,e):e(!1,n)})},n.prototype.deleteNonGroupingItem=function(t,e){var o=this;o._dropboxClient.remove(t,function(t,n){return t?o._showDropboxError(t,e):e(!1,n)})},self.copyItem=function(t,e,o){var n=this;n._dropboxClient.copy(t,e,function(t){return t?n._showDropboxError(t,o):o(!1)})},n.prototype.moveItem=function(t,e,o){var n=this;n._dropboxClient.move(t,e,function(t){return t?n._showDropboxError(t,o):o(!1)})},n.prototype.getURL=function(t,e){var o=this;o._dropboxClient.makeUrl(t,null,function(t,n){return t?o._showDropboxError(t,e):e(!1,n.url)})},n.prototype.listItems=function(t,e){var o=this,n="'"+t+"' in parents",a=this.clientInterface.client.drive.files.list({maxResults:1e3,q:n});a.execute(function(t){if(t.error)return e("Error: Bad Response / Request");var n=t.items.filter(function(t){return t.title!==i.xooMLFragmentFileName}).map(function(t){return new r({commonData:{associatedXooMLFragment:null,associatedItem:t.id,associatedItemDriver:"GoogleItemDriver",associatedXooMLDriver:"GoogleXooMLDriver",associatedSyncDriver:"MirrorSyncDriver",isGrouping:t.mimeType===o._FOLDER_MIMETYPE,localItem:t.id,displayText:t.title}})});e(!1,n)})},n.prototype.checkExisted=function(t,e){var o,n=this;n._dropboxClient.stat(t,function(t,i){return t?n._showDropboxError(t,e):(o=!(null!==t&&404===t.status)||null===t&&i.isRemoved,e(!1,o))})},e.exports=n},{"./AssociationEditor":1,"./XooMLConfig":6}],4:[function(t,e,o){"use strict";function n(t,e){function o(t,o){return t?e(t):(d._xooMLDriver=o,void d._xooMLDriver.getXooMLFragment(n))}function n(o,n){if("XooML Not Found"===o)new s(t.itemDriver,p);else{if(o)return e(o);u(n)}}function u(o){d._fragment=new m({text:o}),new s(t.itemDriver,function(t,o){return t?e(t):(d._itemDriver=o,d._syncDriver=new c(d),void d.refresh(function(){return e(!1,d)}))})}function p(t,e){d._itemDriver=e,d._itemDriver.listItems(d._groupingItemURI,l)}function l(t,o){return t?e(t):(d._fragment=new m({commonData:{itemDescribed:d._groupingItemURI,displayName:g,itemDriver:"dropboxItemDriver",xooMLDriver:"dropboxXooMLDriver",syncDriver:"itemMirrorSyncUtility"},associations:o}),d._syncDriver=new c(d),d._xooMLDriver.setXooMLFragment(d._fragment.toString(),function(t){if(t)throw new Error(t)}),e(!1,d))}if(r.checkCallback(e),!t)return e(i.nullArgument);if(!r.isObject(t))return e(i.invalidType);var f,g,d=this;this._xooMLDriverClient=t.xooMLDriver.clientInterface,this._itemDriverClient=t.xooMLDriver.clientInterface,d._xooMLDriver=null,d._itemDriver=null,d._syncDriver=null,d._creator=t.creator||null,d._groupingItemURI=t.groupingItemURI,d._newItemMirrorOptions=t,g="TBD",d.fragmentURI=t.fragmentURI||null,t.xooMLDriver.fragmentURI=f,new a(t.xooMLDriver,o)}var i=t("./XooMLExceptions"),r=t("./XooMLUtil"),a=t("./XooMLDriver"),s=t("./ItemDriver"),c=t("./SyncDriver"),m=t("./FragmentEditor"),u=t("./AssociationEditor");n.prototype.getDisplayName=function(){return this._fragment.commonData.displayName},n.prototype.setDisplayName=function(t){this._fragment.commonData.displayName=t},n.prototype.getSchemaVersion=function(){return this._fragment.commonData.schemaVersion},n.prototype.getSchemaLocation=function(){return this._fragment.commonData.schemaLocation},n.prototype.getURIforItemDescribed=function(){return this._fragment.commonData.itemDescribed},n.prototype.getAssociationDisplayText=function(t){return this._fragment.associations[t].commonData.displayText},n.prototype.setAssociationDisplayText=function(t,e){this._fragment.associations[t].commonData.displayText=e},n.prototype.getAssociationLocalItem=function(t){return this._fragment.associations[t].commonData.localItem},n.prototype.getAssociationAssociatedItem=function(t){return this._fragment.associations[t].commonData.associatedItem},n.prototype.getFragmentNamespaceAttribute=function(t,e){var o=this._fragment.namespace;return o[e]=o[e]||{},o[e].attributes=o[e].attributes||{},this._fragment.namespace[e].attributes[t]},n.prototype.setFragmentNamespaceAttribute=function(t,e,o){var n=this._fragment.namespace;n[o]=n[o]||{},n[o].attributes=n[o].attributes||{},this._fragment.namespace[o].attributes[t]=e},n.prototype.addFragmentNamespaceAttribute=function(t,e){var o=this._fragment.namespace;if(o[e]=o[e]||{},o[e].attributes=o[e].attributes||{},this._fragment.namespace[e].attributes[t])throw i.invalidState;this.setFragmentNamespaceAttribute(t,e)},n.prototype.removeFragmentNamespaceAttribute=function(t,e){delete this._fragment.namespace[e].attributes[t]},n.prototype.hasFragmentNamespace=function(t){var e=this._fragment.namespace[t];return e?!0:!1},n.prototype.listFragmentNamespaceAttributes=function(t){return Object.keys(this._fragment.namespace[t].attributes)},n.prototype.getFragmentNamespaceData=function(t){return this._fragment.namespace[t].data},n.prototype.setFragmentNamespaceData=function(t,e){var o=this._fragment.namespace;o[e]=o[e]||{},this._fragment.namespace[e].data=t},n.prototype.createItemMirrorForAssociatedGroupingItem=function(t,e){var o,i,r,a,s,c=this;return r={driverURI:"GoogleItemUtility",clientInterface:this._itemDriverClient,associatedItem:c.getAssociationAssociatedItem(t)},i={fragmentURI:s,driverURI:"GoogleXooMLUtility",clientInterface:this._xooMLDriverClient,associatedItem:c.getAssociationAssociatedItem(t)},a={utilityURI:"SyncUtility"},(o=c.isAssociationAssociatedItemGrouping(t))?void new n({groupingItemURI:c.getAssociationAssociatedItem(t),xooMLDriver:i,itemDriver:r,syncDriver:a,creator:c},function(t,o){return e(t,o)}):e("Association not grouping, cannot continue")},n.prototype.createAssociation=function(t,e){var o,n,a=this;if(n=function(t){var o=t.commonData.ID;a._fragment.associations[o]=t,a.save(function(t){return e(t,o)})},!r.isFunction(e))throw i.invalidType;return r.isObject(t)?t.displayText&&t.localItem&&t.isGroupingItem?(o=new u({commonData:{displayText:t.displayText,isGrouping:!0,localItem:t.localItem,associatedItem:t.associatedItem}}),void a._itemDriver.createGroupingItem(t.displayText,function(t){return t?e(t):n(o)})):(t.displayText&&t.itemURI?o=new u({commonData:{displayText:t.displayText,associatedItem:t.itemURI,isGrouping:!1}}):t.displayText&&(o=new u({commonData:{displayText:t.displayText,isGrouping:!1}})),n(o)):e(i.invalidType)},n.prototype.isAssociationPhantom=function(t){var e=this._fragment.associations[t].commonData;return!(e.isGrouping||e.localItem)},n.prototype.copyAssociation=function(){throw new Error("Method not implemented")},n.prototype.moveAssociation=function(){throw new Error("Method not implemented")},n.prototype.deleteAssociation=function(t,e){function o(o){if(o)return e(o);var i=a.isAssociationPhantom(t);if(i)return delete a._fragment.associations[t],a._unsafeWrite(function(t){return t?e(t):e()});var r=a.isAssociationAssociatedItemGrouping(t),s=a.getAssociationAssociatedItem(t);return delete a._fragment.associations[t],r?a._itemDriver.deleteGroupingItem(s,n):a._itemDriver.deleteNonGroupingItem(s,n)}function n(t){return t?e(t):a.refresh(function(t){return e(t?t:t)})}var a=this;return r.checkCallback(e),t?r.isGUID(t)?a.save(o):e(i.invalidType):e(i.nullArgument)},n.prototype.upgradeAssociation=function(){throw new Error("Method not implemented")},n.prototype.renameAssociationLocalItem=function(t,e,o){function n(t){return t?o(t):void m._itemDriver.rename(e,a)}function a(n){return n?o(n):(m._fragment.associations[t].commonData.localItem=e,void m._unsafeWrite(s))}function s(t){return t?o(t):void m.refresh(c)}function c(e){return o(e,m._fragment.associations[t].commonData.ID)}var m=this;return r.checkCallback(o),t?r.isGUID(t)?void m.save(n):o(i.invalidType):o(i.nullArgument)},n.prototype._unsafeWrite=function(t){var e=this;return e._fragment.updateID(),e._xooMLDriver.setXooMLFragment(e._fragment.toString(),function(e){return t(e?e:!1)})},n.prototype.isAssociationAssociatedItemGrouping=function(t){return this._fragment.associations[t].commonData.isGrouping},n.prototype.listAssociations=function(){return Object.keys(this._fragment.associations)},n.prototype.getAssociationNamespaceAttribute=function(t,e,o){var n=this._fragment.associations[e].namespace;return n[o]=n[o]||{},n[o].attributes=n[o].attributes||{},this._fragment.associations[e].namespace[o].attributes[t]},n.prototype.setAssociationNamespaceAttribute=function(t,e,o,n){var i=this._fragment.associations[o].namespace;i[n]=i[n]||{},i[n].attributes=i[n].attributes||{},this._fragment.associations[o].namespace[n].attributes[t]=e},n.prototype.addAssociationNamespaceAttribute=function(t,e,o,n){var r=this._fragment.associations[o].namespace;if(r[n]=r[n]||{},r[n].attributes=r[n].attributes||{},this._fragment.associations[o].namespace[n].attributes[t])throw i.invalidState;this.setAssociationNamespaceAttribute(t,e,o,n)},n.prototype.removeAssociationNamespaceAttribute=function(t,e,o){delete this._fragment.associations[e].namespace[o].attributes[t]},n.prototype.hasAssociationNamespace=function(t,e){var o=this._fragment.associations[t].namespace[e];return o?!0:!1},n.prototype.listAssociationNamespaceAttributes=function(t,e){var o=this._fragment.associations[t].namespace;return o[e]=o[e]||{},o[e].attributes=o[e].attributes||{},Object.keys(this._fragment.associations[t].namespace[e].attributes)},self.getAssociationNamespaceData=function(t,e){var o=this._fragment.associations[t].namespace;return o[e]=o[e]||{},o[e].attributes=o[e].attributes||{},this._fragment.associations[t].namespace[e].data},n.prototype.setAssociationNamespaceData=function(t,e,o){var n=this._fragment.associations[e].namespace;n[o]=n[o]||{},n[o].attributes=n[o].attributes||{},this._fragment.associations[e].namespace[o].data=t},n.prototype._sync=function(t){var e=this;e._syncDriver.sync(t)},n.prototype.refresh=function(t){function e(e,n){return e?t(e):(o._fragment=new m({text:n}),t(!1))}var o=this;o._sync(function(n){n===i.itemMirrorNotCurrent?o._xooMLDriver.getXooMLFragment(e):n?t(n):o._xooMLDriver.getXooMLFragment(e)})},n.prototype.getCreator=function(){return this._creator},n.prototype.save=function(t){function e(e){return e?t(e):n._unsafeWrite(o)}function o(e){return t(e)}var n=this;n._sync(e)},self._isURL=function(t){return/^http:\/\//.exec(t)},e.exports=n,window&&(window.ItemMirror=window.ItemMirror||n)},{"./AssociationEditor":1,"./FragmentEditor":2,"./ItemDriver":3,"./SyncDriver":5,"./XooMLDriver":7,"./XooMLExceptions":8,"./XooMLUtil":9}],5:[function(t,e,o){"use strict";function n(t){var e=this;e._itemMirror=t,e._itemDriver=t._itemDriver,e._xooMLDriver=t._xooMLDriver}function i(t,e){return t.commonData.localItem>e.commonData.localItem?1:t.commonData.localItem<e.commonData.localItem?-1:0}var r=(t("./XooMLExceptions"),t("./XooMLConfig"),t("./XooMLUtil"),t("./FragmentEditor"));t("./AssociationEditor"),t("./XooMLExceptions");n.prototype.sync=function(t){function e(e,i){return e?t(e):(n=i,void a._xooMLDriver.getXooMLFragment(o))}function o(e,o){if(404===e){var s=a._itemMirror._fragment.toString();return a._xooMLDriver.setXooMLFragment(s,function(e){t(e?e:!1)})}if(e)return t(e);var c,m=0,u=!0;a._fragmentEditor=new r({text:o}),c=Object.keys(a._fragmentEditor.associations).map(function(t){return a._fragmentEditor.associations[t]}).filter(function(t){return null!==t.commonData.localItem}),n.sort(i),c.sort(i);var p=n.map(function(t){return t.commonData.localItem}),l=c.map(function(t){return t.commonData.localItem});return p.forEach(function(t,e){var o=l.lastIndexOf(t,m);if(-1===o){u=!1;var i=n[e];a._fragmentEditor.associations[i.commonData.ID]=i}else c.slice(m,o).forEach(function(t){u=!1,delete a._fragmentEditor.associations[t.guid]}),m=o+1}),c.slice(m,l.length).forEach(function(t){u=!1,delete a._fragmentEditor.associations[t.commonData.ID]}),u?t(!1):(a._fragmentEditor.updateID(),void a._xooMLDriver.setXooMLFragment(a._fragmentEditor.toString(),function(e){return t(e?e:!1)}))}var n,a=this;a._itemDriver.listItems(a._itemMirror._groupingItemURI,e)},e.exports=n},{"./AssociationEditor":1,"./FragmentEditor":2,"./XooMLConfig":6,"./XooMLExceptions":8,"./XooMLUtil":9}],6:[function(t,e,o){e.exports={schemaVersion:"0.54",schemaLocation:"http://kftf.ischool.washington.edu/xmlns/xooml",xooMLFragmentFileName:"XooML2.xml",maxFileLength:50,createAssociationSimple:{displayText:!0},createAssociationLinkNonGrouping:{displayText:!0,itemURI:!0,localItemRequested:!1},createAssociationLinkGrouping:{displayText:!0,groupingItemURI:!0,xooMLDriverURI:!0},createAssociationCreate:{displayText:!0,itemName:!0,isGroupingItem:!0}}},{}],7:[function(t,e,o){function n(t,e){var o=this;if(!t.clientInterface)throw new Error("Missing client interface in options!");this._parentURI=t.associatedItem||"root",this.clientInterface=t.clientInterface,this._fragmentURI=t.fragmentURI?t.fragmentURI:null;var n=this.clientInterface.auth2.getAuthInstance().currentUser.get().getAuthResponse();return this._AUTH_HEADER={Authorization:"Bearer "+n.access_token},this._DRIVE_FILE_API="https://www.googleapis.com/drive/v2/files/",e(!1,o)}var i=(t("./XooMLExceptions"),t("./XooMLConfig"));n.prototype._readFile=function(t){var e=this;$.ajax({url:e._DRIVE_FILE_API+e._fragmentURI,data:"alt=media",dataType:"text",headers:e._AUTH_HEADER}).then(function(e){t(!1,e)})},n.prototype._searchXooML=function(t,e){var o=this,n="title = '"+i.xooMLFragmentFileName+"' and '"+e+"' in parents",r=this.clientInterface.client.drive.files.list({maxResults:10,q:n});r.execute(function(e){var n=e.items[0];return e.items.length>1&&(console.warn("Mutliple XooML files found, only using first one. Please delete extras"),console.log(e.items)),n?(o._fragmentURI=n.id,void o._readFile(t)):t("XooML Not Found")})},n.prototype.getXooMLFragment=function(t){return this._fragmentURI?(console.log("GENERAL CASE"),void this._readFile(t,this._fragmentURI)):(console.log("SEARCH CASE"),this._searchXooML(t,this._parentURI))},n.prototype.setXooMLFragment=function(t,e){function o(e){var o=gapi.client.request({path:"/upload/drive/v2/files/"+r._fragmentURI,method:"PUT",params:{uploadType:"media"},body:t});o.execute(function(t){e(!1)},function(t){console.error(t),e(t)})}function n(t,e){var o="-------314159265358979323846",n="\r\n--"+o+"\r\n",a="\r\n--"+o+"--",s=new FileReader;s.readAsBinaryString(t),s.onload=function(c){var m=t.type||"application/octet-stream",u={title:i.xooMLFragmentFileName,mimeType:m,parents:[{kind:"drive#parentReference",id:r._parentURI}]};console.log("XooML Metadata for writing"),console.log(u);var p=btoa(s.result),l=n+"Content-Type: application/json\r\n\r\n"+JSON.stringify(u)+n+"Content-Type: "+m+"\r\nContent-Transfer-Encoding: base64\r\n\r\n"+p+a,f=gapi.client.request({path:"/upload/drive/v2/files",method:"POST",params:{uploadType:"multipart"},headers:{"Content-Type":'multipart/mixed; boundary="'+o+'"'},body:l});f.execute(function(t){r._fragmentURI=t.id,e(!1)},function(t){e("Could not write out XooML Fragment",t)})}}var r=this,a="text/xml",s=new Blob([t],{type:a,fileName:i.xooMLFragmentFileName});r._fragmentURI?o(e):n(s,e)},n.prototype.checkExists=function(t){var e=this;if(this._fragmentURI)$.get({url:_DRIVE_FILE_API+e._fragmentURI,headers:_AUTH_HEADER}).then(function(){t(!1)}).fail(function(){t("XooML file: "+e._fragmentURI+" not found")});else{var o="title = '"+i.xooMLFragmentFileName+"' and '"+e._parentURI+"' in parents",n=this.clientInterface.client.drive.files.list({maxResults:1,q:o});n.execute(function(o){t(o.items[0]?!1:"XooML file not found in directory: "+e._parentURI)})}},e.exports=n},{"./XooMLConfig":6,"./XooMLExceptions":8}],8:[function(t,e,o){e.exports={notImplemented:"NotImplementedException",missingParameter:"MissingParameterException",nullArgument:"NullArgumentException",invalidType:"InvalidTypeException",invalidState:"InvalidStateArgument",xooMLUException:"XooMLUException",itemUException:"ItemUException",nonUpgradeableAssociationException:"NonUpgradeableAssociationException",invalidArgument:"InvalidOptionsException",itemAlreadyExists:"ItemAlreadyExistsException",itemMirrorNotCurrent:"ItemMirrorNotCurrent"}},{}],9:[function(t,e,o){"use strict";var n=t("./XooMLExceptions"),i=(t("./XooMLConfig"),{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object","[object Error]":"error"}),r={hasOptions:function(t,e){if(!t||!e)throw n.nullArgument;if(!r.isObject(t)||!r.isObject(e))throw n.invalidType;var o,i,a;if(a=0,!(Object.keys(e).length<=Object.keys(t).length))return!1;for(o in t)if(t.hasOwnProperty(o)&&(i=t[o],!e.hasOwnProperty(o))){if(i)return!1;a+=1}return Object.keys(e).length<=Object.keys(t).length-a},checkCallback:function(t){if(!t)throw n.nullArgument;if(!r.isFunction(t))throw n.invalidType},isGUID:function(t){return"string"===r.getType(t)?!0:!1},isArray:function(t){return"array"===r.getType(t)},isObject:function(t){return"object"===r.getType(t)},isFunction:function(t){return null!==t},isString:function(t){return"string"===r.getType(t)},isBoolean:function(t){return"boolean"===r.getType(t)},generateGUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,o="x"==t?e:3&e|8;return o.toString(16)})},getType:function(t){return null===t?String(t):"object"==typeof t||"function"==typeof t?i[t.toString()]||"object":typeof t},endsWith:function(t,e){return-1!==t.indexOf(e,t.length-e.length)},clone:function(t){var e;if(null===t||"object"!=typeof t)return t;if(t instanceof Date)return e=new Date,e.setTime(t.getTime()),e;if(t instanceof Array){e=[];for(var o=0,i=t.length;i>o;o++)e[o]=r.clone(t[o]);return e}if(t instanceof Object){e={};for(var a in t)t.hasOwnProperty(a)&&(e[a]=r.clone(t[a]));return e}throw n.invalidType}};e.exports=r},{"./XooMLConfig":6,"./XooMLExceptions":8}]},{},[4]);
//# sourceMappingURL=item-mirror.js.map
